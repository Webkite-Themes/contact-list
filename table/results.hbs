{{log this}}

{{>name}}
{{>embed}}

{{>header}}

{{#if items.length}}
  {{#with items}}
    <table>
      <thead class="until-xs">
        <tr>
          {{#unless (find ../facets name="Image" empty=true)}}
            <th class="image-thumbnail"></th>
          {{/unless}}
          <th class="webkite-name webkite-apply-sort">
            {{#if (contains ../sort.sortableFacets "Last Name")}}
              <a href="#" data-sort="Last Name" class="{{../../currentDirection}}">{{t "Name" default="Name"}}</a>
            {{else}}
              <span>{{t "Name" default="Name"}}</span>
            {{/if}}
          </th>
          <th class="webkite-address until-xs"><span class="md-only">{{t "Address" default="Address"}}</span></th>
          <th class="webkite-phone until-sm">{{#with (find ../facets name="Phone Number")}}{{displayName}}{{/with}}</th>
          <th class="open-toggle"></th>
        </tr>
      </thead>
      {{#each this}}
        <tbody>
          <tr class="webkite-result">
            {{#unless (find ../../facets name="Image" empty=true)}}    
              <td class="image-thumbnail until-xs">
                {{#facet name="Image"}}<div class="image-thumbnail" style="background-image:url({{displayValue}});"></div>{{/facet}}
              </td>
            {{/unless}}
            <td class="webkite-name">
              <div class="content-wrapper">
                <ul>
                  {{#any (find facets name="First Name") (find facets name="Last Name")}}
                    <li>
                      {{#facet name="First Name"}}<h2>{{displayValue}} </h2>{{/facet}} 
                      {{#facet name="Last Name"}}<h2>{{displayValue}}</h2>{{/facet}}
                    </li>
                  {{/any}}
                  {{#facet name="Email"}}
                    <li>
                      <b class="xs-only">{{downcase displayName}}</b>
                      <span class="facet-values"><a href="mailto:{{displayValue}}" class="webkite-email">{{displayValue}}</a></span>
                    </li>
                  {{/facet}}
                  {{#any (find facets name="Address 1") (find facets name="City") (find facets name="State") (find facets name="Zip Code") (find facets name="Country") (find facets name="Address 2")}}
                    <li class="xs-only">
                      <b>{{downcase (t "Address" default="address")}}</b>
                      <span class="facet-values address">
                        <a class="webkite-address" target="_blank" href="http://maps.google.com/?q={{#facet name='Address 1'}}{{displayValue}}{{/facet}} {{#facet name='City'}}{{displayValue}}{{/facet}} {{#facet name='State'}}{{displayValue}}{{/facet}} {{#facet name='Zip Code'}}{{displayValue}}{{/facet}} {{#facet name='Country'}}{{displayValue}}{{/facet}}">
                          {{#facet name="Address 1"}}<span>{{displayValue}}</span>{{/facet}}
                          {{#facet name="Address 2"}}<span>{{displayValue}}</span>{{/facet}}
                          <span>
                            {{~#facet name="City"}}<span class="city">{{displayValue}}</span>{{/facet}}
                            {{~#facet name="State"}}<span class="state">{{displayValue}}</span>{{/facet}}
                            {{#facet name="Zip Code"}}{{displayValue}}{{/facet~}}
                          </span>
                          {{~#facet name="Country"}}<span>{{displayValue}}</span>{{/facet}}
                        </a>
                      </span>
                    </li>
                  {{/any}}
                  {{#facet name="Phone Number"}}
                    <li class="xs-only">
                      <b>{{downcase displayName}}</b>
                      <span class="facet-values"><a href="tel:{{displayValue}}">{{displayValue}}</a></span>
                    </li>
                  {{/facet}}
                </ul>
              </div>
            </td>
            <td class="webkite-address until-xs">
              <div class="content-wrapper">
                <ul>
                  {{#any (find facets name="Address 1") (find facets name="City") (find facets name="State") (find facets name="Zip Code") (find facets name="Country") (find facets name="Address 2")}}
                    <li>
                      <b class="sm-only">{{downcase (t "Address" default="address")}}</b>
                      <span class="facet-values address">
                        <a class="webkite-address" target="_blank" href="http://maps.google.com/?q={{#facet name='Address 1'}}{{displayValue}}{{/facet}} {{#facet name='City'}}{{displayValue}}{{/facet}} {{#facet name='State'}}{{displayValue}}{{/facet}} {{#facet name='Zip Code'}}{{displayValue}}{{/facet}} {{#facet name='Country'}}{{displayValue}}{{/facet}}">
                          {{#facet name="Address 1"}}<span>{{displayValue}}</span>{{/facet}}
                          {{#facet name="Address 2"}}<span>{{displayValue}}</span>{{/facet}}
                          <span>
                            {{~#facet name="City"}}<span class="city">{{displayValue}}</span>{{/facet}}
                            {{~#facet name="State"}}<span class="state">{{displayValue}}</span>{{/facet}}
                            {{#facet name="Zip Code"}}<span class="zip">{{displayValue}}</span>{{/facet~}}
                          </span>
                          {{~#facet name="Country"}}<span>{{displayValue}}</span>{{/facet}}
                        </a>
                      </span>
                    </li>
                  {{/any}}
                  {{#facet name="Phone Number"}}
                    <li class="sm-only">
                      <b>{{downcase displayName}}</b>
                      <span class="facet-values"><a href="tel:{{displayValue}}">{{displayValue}}</a></span>
                    </li>
                  {{/facet}}
                </ul>
              </div>
            </td>
            <td class="webkite-phone md-only">
              {{#facet name="Phone Number"}}<a href="tel:{{displayValue}}">{{displayValue}}</a>{{/facet}}
            </td>
            <td class="open-toggle">
              {{#any (find facets name="Image") (find facets name="Website") (find facets name="Twitter") (find facets name="University") (find facets name="Degree") (find facets name="Year of Graduation") (find facets name="Employer") (find facets name="Department") (find facets name="Job Title")}}
                <a href="#{{this.id}}" data-id={{this.id}} class="webkite-toggle-item webkite-toggle {{this.id}}-toggler {{#if showDetails}}webkite-hide{{/if}} more-button" data-target=".{{this.id}}-toggler" data-animate="200ms"></a>
                <a href="#{{this.id}}" data-id={{this.id}} class="webkite-toggle-item webkite-toggle {{this.id}}-toggler {{#unless showDetails}}webkite-hide{{/unless}} less-button" data-target=".{{this.id}}-toggler" data-animate="200ms"></a>
              {{/any}}
            </td>
          </tr>
          
          {{#if (find ../../facets name="Image" empty=true)}}
            {{#any (find facets name="Image") (find facets name="Website") (find facets name="Twitter") (find facets name="University") (find facets name="Degree") (find facets name="Year of Graduation") (find facets name="Employer") (find facets name="Department") (find facets name="Job Title")}}
              <tr id="{{this.id}}" class="webkite-item-details">
                <td class="until-xs"></td>
                <td colspan="3">
                  {{>result-details}}
                </td>
              </tr>
            {{/any}}
          {{else}}
            {{#any (find facets name="Image") (find facets name="Website") (find facets name="Twitter") (find facets name="University") (find facets name="Degree") (find facets name="Year of Graduation") (find facets name="Employer") (find facets name="Department") (find facets name="Job Title")}}
              <tr id="{{this.id}}" class="webkite-item-details">
                <td colspan="2" class="webkite-full-image until-xs">
                  <ul>{{#facet name="Image"}}<img src="{{displayValue}}"/>{{/facet}}</ul>
                </td>
                <td colspan="3">      
                  {{>result-details}}
                </td>
              </tr>
            {{/any}}
          {{/if}}
        </tbody>
      {{/each}}
    </table>
  {{/with}}
{{else}}
  {{>noresult}}
{{/if}}

{{>footer}}